<RoundButton@Button>:
    bg: 0.23, 0.23, 0.23, 1
    background_color: 0, 0, 0, 0
    color: 1, 1, 1, 1
    font_size: dp(32)

    canvas.before:
        Color:
            rgba: (self.bg[0]*0.85, self.bg[1]*0.85, self.bg[2]*0.85, 1) if self.state == "down" else self.bg
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [40]

    canvas.after:
        Color:
            rgba: 1, 1, 1, 0.06
        Line:
            rounded_rectangle: (self.x, self.y, self.width, self.height, 40)
            width: 1.1


<NumberButton@RoundButton>:
    bg: 0.25, 0.25, 0.25, 1

<OperatorButton@RoundButton>:
    bg: 1, 0.55, 0.15, 1

<SpecialButton@RoundButton>:
    bg: 0.70, 0.70, 0.70, 1


<CalculatorLayout>:
    orientation: "vertical"
    padding: dp(18)
    spacing: dp(12)

    # ===== DISPLAY =====
    BoxLayout:
        size_hint_y: None
        height: dp(120)
        padding: dp(14)
        canvas.before:
            Color:
                rgba: 0.10, 0.10, 0.10, 1
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [24]

        Label:
            text: root.display_text
            font_size: dp(48)
            halign: "right"
            valign: "middle"
            text_size: self.size
            color: 1, 1, 1, 1

    # ===== GRID 4x4 =====
    GridLayout:
        cols: 4
        spacing: dp(12)
        size_hint_y: None
        row_default_height: dp(80)
        row_force_default: True
        height: self.minimum_height

        SpecialButton:
            text: "C"
            on_press: root.clear_display()

        OperatorButton:
            text: "/"
            on_press: root.press_button("/")

        OperatorButton:
            text: "x"
            on_press: root.press_button("*")

        OperatorButton:
            text: "-"
            on_press: root.press_button("-")

        NumberButton:
            text: "7"
            on_press: root.press_button("7")

        NumberButton:
            text: "8"
            on_press: root.press_button("8")

        NumberButton:
            text: "9"
            on_press: root.press_button("9")

        OperatorButton:
            text: "+"
            on_press: root.press_button("+")

        NumberButton:
            text: "4"
            on_press: root.press_button("4")

        NumberButton:
            text: "5"
            on_press: root.press_button("5")

        NumberButton:
            text: "6"
            on_press: root.press_button("6")

        OperatorButton:
            text: "^"
            on_press: root.press_button("^")

        NumberButton:
            text: "1"
            on_press: root.press_button("1")

        NumberButton:
            text: "2"
            on_press: root.press_button("2")

        NumberButton:
            text: "3"
            on_press: root.press_button("3")

        OperatorButton:
            text: "="
            on_press: root.calculate()

    # ===== FULL WIDTH ZERO =====
    BoxLayout:
        size_hint_y: None
        height: dp(80)

        RoundButton:
            text: "0"
            bg: 0.25, 0.25, 0.25, 1
            font_size: dp(32)
            on_press: root.press_button("0")
